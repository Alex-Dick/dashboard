
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Dashboard</title>
  <style>
    :root{
      --bg-url: url('file://Winter_1.jpg');
      --bg-blur: 0px;
      --bg-dim: 0.35;
      --panel-bg: rgba(15,23,42,0.55);
      --calendar-opacity: 0.5;   /* calendar opacity */
      --date-font-size: 2.6rem;
      --weather-opacity: 0.9;    /* weather widget overall opacity: 0.6–1.0 */
    }

    html, body { height: 100%; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }

    .bg { position: fixed; inset: 0; z-index: -2; background-image: var(--bg-url); background-size: cover; background-position: center; background-repeat: no-repeat; -webkit-filter: blur(var(--bg-blur)); filter: blur(var(--bg-blur)); transform: translateZ(0); }
    .bg-dim { position: fixed; inset: 0; z-index: -1; background: rgba(15,23,42, var(--bg-dim)); }

    body { background:#0f172a; color:#e2e8f0; }

    .wrap { position: relative; width: 100%; min-height: 100vh; box-sizing: border-box; padding: 46px; gap: 16px; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; }

    .left, .right { box-sizing: border-box; }

    /* Left column becomes a stack: clock panel + weather panel */
    .left { -webkit-box-flex: 1; -ms-flex: 1 1 45%; flex: 1 1 45%; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: vertical; -webkit-box-direction: normal; -ms-flex-direction: column; flex-direction: column; gap: 16px; border: none; background: transparent; padding: 0; }

    .panel { border: 1px solid rgba(255,255,255,0.12); border-radius: 12px; background: var(--panel-bg); position: relative; overflow: hidden; }
    .panel-content { padding: 12px; }

    .right { -webkit-box-flex: 1; -ms-flex: 1 1 55%; flex: 1 1 55%; position: relative; padding: 0; overflow: hidden; border: 1px solid rgba(255,255,255,0.12); border-radius: 12px; background: var(--panel-bg); }

    .header-bar { position: absolute; bottom: 8px; left: 8px; z-index: 3; display: -webkit-box; display: -ms-flexbox; display: flex; align-items: center; gap: 6px; padding: 6px 8px; background: rgba(15,23,42,0.7); border: 1px solid rgba(255,255,255,0.18); border-radius: 10px; }
    .header-bar label { font-size: 0.9rem; opacity: 0.9; }
    .header-bar select { background: rgba(255,255,255,0.12); color: #e2e8f0; border: 1px solid rgba(255,255,255,0.18); border-radius: 8px; padding: 6px 10px; font-size: 0.9rem; -webkit-appearance: none; appearance: none; }

    .date-line { font-size: var(--date-font-size); font-weight: 600; opacity: 0.95; margin-bottom: 12px; text-shadow: 0 1px 2px rgba(0,0,0,0.6); text-align:center; }
    .clock { text-align: center; font-variant-numeric: tabular-nums; line-height: 1; }
    .time { font-size: 14vw; font-weight: 700; text-shadow: 0 2px 8px rgba(0,0,0,0.5); }
    .seconds { font-size: 7vw; opacity: 0.9; margin-left: 0.4em; text-shadow: 0 2px 8px rgba(0,0,0,0.5); display: none; }

    .cal-frame { position: absolute; top:0; left:0; width:100%; height:100%; border:0; background: transparent; opacity: var(--calendar-opacity); }
    .dark-embed .cal-frame { -webkit-filter: invert(1) hue-rotate(180deg); filter: invert(1) hue-rotate(180deg); }

    /* Weather widget transparency: remove any internal backgrounds and set overall opacity */
    .weather-box { padding: 8px; }
    .weatherwidget-io { background: transparent !important; border: 0 !important; opacity: var(--weather-opacity); }
    /* If the widget injects an iframe, make sure it is also transparent */
    .weather-box iframe { background: transparent !important; }

    @media (orientation: portrait) { .wrap { -webkit-box-orient: vertical; -ms-flex-direction: column; flex-direction: column; } .time { font-size: 18vw; } .seconds { font-size: 9vw; } }
  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="bg-dim"></div>

  <div id="wrap" class="wrap">
    <div class="left">
      <!-- CLOCK PANEL -->
      <section class="panel" aria-label="Uhr Panel">
        <div class="panel-content">
          <div id="dateLine" class="date-line">–</div>
          <div class="clock">
            <span id="hoursMinutes" class="time">00:00</span>
            <span id="seconds" class="seconds">00</span>
          </div>
        </div>
      </section>

      <!-- WEATHER PANEL (transparent widget) -->
      <section class="panel" aria-label="Wetter Panel">
        <div class="panel-content weather-box">
          <a class="weatherwidget-io" href="https://forecast7.com/en/48d372010/augsburg/"
             data-label_1="Augsburg" data-label_2="Wetter" data-icons="Climacons Animated"
             data-mode="Forecast" data-days="5" data-theme="dark"
             data-basecolor="rgba(0,0,0,0)" data-textcolor="#e2e8f0" data-highcolor="#f87171" data-lowcolor="#60a5fa">Augsburg Wetter</a>
        </div>
      </section>
    </div>

    <div class="right dark-embed">
      <iframe id="gcal" 
            class="cal-frame"
            src="https://calendar.google.com/calendar/embed?height=600&amp;wkst=2&amp;ctz=Europe%2FBerlin&amp;showPrint=0&amp;showTz=0&amp;showCalendars=0&amp;src=YWxleC5kaWNrLmdtQGdvb2dsZW1haWwuY29t&amp;src=ZGUuZ2VybWFuI2hvbGlkYXlAZ3JvdXAudi5jYWxlbmRhci5nb29nbGUuY29t&amp;color=%238c500b&amp;color=%23060d5e" style="border-width:0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
    </div>
  </div>

  <script>
    (function(){
      function pad(n){ return (n < 10 ? '0' : '') + n; }
      function formatDateLine(d){
        var weekdays = ['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'];
        var months = ['Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'];
        return weekdays[d.getDay()] + ', ' + d.getDate() + '. ' + months[d.getMonth()] + ' ' + d.getFullYear();
      }
      function updateClock(){
        var now = new Date();
        document.getElementById('hoursMinutes').textContent = pad(now.getHours()) + ':' + pad(now.getMinutes());
        var ssEl = document.getElementById('seconds');
        if (ssEl) ssEl.textContent = pad(now.getSeconds());
        document.getElementById('dateLine').textContent = formatDateLine(now);
      }
      updateClock(); setInterval(updateClock, 1000);

      function setHeights(){
        var wrap = document.getElementById('wrap');
        var gcal = document.getElementById('gcal');
        var h = window.innerHeight || document.documentElement.clientHeight || 600;
        if (wrap) wrap.style.height = h + 'px';
        if (gcal) {
          var src = gcal.getAttribute('src') || '';
          src = src.replace(/([&?])height=\d+/,'$1');
          var sep = src.indexOf('?') === -1 ? '?' : '&';
          src = src + sep + 'height=' + h;
          gcal.setAttribute('src', src);
        }
      }

      function setMode(mode){
        try {
          var gcal = document.getElementById('gcal');
          var src = gcal.getAttribute('src') || '';
          if (/([&?])mode=([A-Z]+)/.test(src)) {
            src = src.replace(/([&?])mode=([A-Z]+)/, '$1mode=' + mode);
          } else {
            var sep = src.indexOf('?') === -1 ? '?' : '&';
            src = src + sep + 'mode=' + mode;
          }
          gcal.setAttribute('src', src);
          try { localStorage.setItem('calMode', mode); } catch(e){}
        } catch(e){}
      }

      function initMode(){
        var saved = null; try { saved = localStorage.getItem('calMode'); } catch(e){}
        var select = document.getElementById('viewSelect');
        var mode = saved || 'MONTH';
        if (select) select.value = mode;
        setMode(mode);
        setHeights();
      }

      var select = document.getElementById('viewSelect');
      if (select) {
        select.addEventListener('change', function(){
          setMode(select.value);
          setTimeout(setHeights, 300);
        });
      }

      // Load WeatherWidget.io script
      function loadWeatherWidget(){
        var d=document, s='script', id='weatherwidget-io-js';
        if (!d.getElementById(id)){
          var js=d.createElement(s); js.id=id; js.src='https://weatherwidget.io/js/widget.min.js';
          var fjs=d.getElementsByTagName(s)[0]; fjs.parentNode.insertBefore(js, fjs);
        }
      }

      initMode();
      loadWeatherWidget();
      window.addEventListener('resize', function(){ setTimeout(setHeights, 100); });
      window.addEventListener('orientationchange', function(){ setTimeout(setHeights, 250); });
    })();
  </script>
</body>
</html>
