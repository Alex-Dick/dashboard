<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Dashboard iOS 9</title>
  <style>
    /* Absolute Basics für iOS 9 */
    html, body { height: 100%; margin: 0; padding: 0; font-family: Helvetica, Arial, sans-serif; background: #000; color: #fff; }
    .bg-fixed { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; }
    
    /* Layout Tabelle: Das Sicherste für alte iPads */
    .main-table { width: 100%; height: 100%; border-spacing: 20px; table-layout: fixed; }
    .td-left { width: 34%; vertical-align: middle; }
    .td-right { width: 66%; vertical-align: top; background: rgba(30, 41, 59, 0.6); border: 1px solid #444; border-radius: 20px; }

    .panel-clock { text-align: center; background: rgba(30, 41, 59, 0.6); border: 1px solid #444; border-radius: 20px; padding: 40px 10px; }
    .time { font-size: 70px; font-weight: bold; display: block; }
    .date { font-size: 20px; color: #ccc; }

    /* Header */
    .cal-header { background: rgba(255,255,255,0.1); padding: 10px; border-bottom: 1px solid #444; }
    .btn { background: #444; border: 1px solid #666; color: #fff; padding: 10px 15px; border-radius: 5px; font-size: 16px; }
    .btn-active { background: #3b82f6; }

    /* Grid per Floats */
    .grid-container { padding: 10px; overflow-y: auto; height: 500px; }
    
    /* Monats-Zellen */
    .cell-kw { float: left; width: 30px; height: 75px; color: #666; font-size: 10px; padding-top: 25px; text-align: center; }
    .cell-day { float: left; width: 13%; height: 75px; border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box; font-size: 12px; }
    .cell-header { float: left; width: 13%; text-align: center; font-weight: bold; font-size: 12px; padding-bottom: 5px; }
    .cell-header-kw { float: left; width: 30px; }

    /* Wochen-Zellen (Google Style) */
    .week-scroll { height: 1000px; position: relative; }
    .week-time-col { float: left; width: 40px; border-right: 1px solid #333; }
    .week-day-col { float: left; width: 13.5%; height: 1000px; border-right: 1px solid #222; position: relative; }
    .time-mark { height: 40px; font-size: 10px; color: #666; text-align: center; border-bottom: 1px solid #111; }
    
    .event { position: absolute; left: 2px; right: 2px; border-radius: 3px; font-size: 9px; padding: 2px; border-left: 3px solid #fff; overflow: hidden; }
    .m-event { font-size: 9px; padding: 1px; margin: 1px; border-left: 2px solid #3b82f6; background: rgba(59,130,246,0.2); overflow: hidden; white-space: nowrap; }

    .clearfix:after { content: ""; display: table; clear: both; }
  </style>
</head>
<body>

  <div class="bg-fixed" style="background: #111;"></div>

  <table class="main-table">
    <tr>
      <td class="td-left">
        <div class="panel-clock">
          <span id="txtDate" class="date">-</span>
          <span id="txtTime" class="time">00:00</span>
        </div>
      </td>
      <td class="td-right">
        <div class="cal-header clearfix">
          <div style="float:left;">
            <button class="btn" id="btnPrev">&lt;</button>
            <button class="btn" id="btnNext">&gt;</button>
          </div>
          <div id="txtMonth" style="float:left; width:50%; text-align:center; font-weight:bold; padding-top:8px;">-</div>
          <div style="float:right;">
            <button class="btn btn-active" id="modeM">M</button>
            <button class="btn" id="modeW">W</button>
          </div>
        </div>
        
        <div class="grid-container" id="gridCont">
           <div id="gridInner" class="clearfix"></div>
        </div>
      </td>
    </tr>
  </table>

  <script>
    var currentMode = 'M';
    var viewDate = new Date();
    var events = {};

    function updateTime() {
      var now = new Date();
      var hh = now.getHours(); if(hh<10) hh='0'+hh;
      var mm = now.getMinutes(); if(mm<10) mm='0'+mm;
      document.getElementById('txtTime').innerHTML = hh + ':' + mm;
      document.getElementById('txtDate').innerHTML = now.getDate() + '.' + (now.getMonth()+1) + '.';
    }
    setInterval(updateTime, 1000); updateTime();

    function getKW(d) {
      var date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      date.setUTCDate(date.getUTCDate() + 4 - (date.getUTCDay()||7));
      var start = new Date(Date.UTC(date.getUTCFullYear(),0,1));
      return Math.ceil((((date - start) / 86400000) + 1)/7);
    }

    function render() {
      var inner = document.getElementById('gridInner');
      inner.innerHTML = '';
      
      if(currentMode === 'M') {
        renderMonth(inner);
      } else {
        renderWeek(inner);
      }
    }

    function renderMonth(container) {
      var y = viewDate.getFullYear(), m = viewDate.getMonth();
      document.getElementById('txtMonth').innerHTML = (m+1) + ' / ' + y;

      container.innerHTML += '<div class="cell-header-kw">&nbsp;</div>';
      var days = ['Mo','Di','Mi','Do','Fr','Sa','So'];
      for(var i=0; i<7; i++) container.innerHTML += '<div class="cell-header">'+days[i]+'</div>';

      var firstDay = new Date(y, m, 1).getDay(); firstDay = (firstDay === 0) ? 6 : firstDay - 1;
      var lastDate = new Date(y, m + 1, 0).getDate();

      container.innerHTML += '<div class="cell-kw">' + getKW(new Date(y, m, 1)) + '</div>';

      for(var i=0; i<firstDay; i++) container.innerHTML += '<div class="cell-day" style="border:none"></div>';

      for(var d=1; d<=lastDate; d++) {
        var cur = new Date(y, m, d);
        if(cur.getDay() === 1 && d > 1) {
          container.innerHTML += '<div class="cell-kw">' + getKW(cur) + '</div>';
        }
        var dDiv = document.createElement('div');
        dDiv.className = 'cell-day';
        dDiv.innerHTML = '<div style="padding:2px"><b>' + d + '</b></div>';
        
        var key = y+'-'+m+'-'+d;
        if(events[key]) {
          for(var e=0; e<events[key].length; e++) {
            dDiv.innerHTML += '<div class="m-event" style="border-left-color:'+events[key][e].c+'">' + events[key][e].t + '</div>';
          }
        }
        container.appendChild(dDiv);
      }
    }

    function renderWeek(container) {
      var start = new Date(viewDate);
      var day = start.getDay();
      start.setDate(start.getDate() - (day === 0 ? 6 : day - 1));
      document.getElementById('txtMonth').innerHTML = 'KW ' + getKW(start);

      var scroll = document.createElement('div'); scroll.className = 'week-scroll clearfix';
      
      var timeCol = document.createElement('div'); timeCol.className = 'week-time-col';
      for(var h=0; h<24; h++) timeCol.innerHTML += '<div class="time-mark">' + h + ':00</div>';
      scroll.appendChild(timeCol);

      for(var j=0; j<7; j++) {
        var d = new Date(start); d.setDate(start.getDate() + j);
        var col = document.createElement('div'); col.className = 'week-day-col';
        
        var key = d.getFullYear()+'-'+d.getMonth()+'-'+d.getDate();
        if(events[key]) {
          for(var e=0; e<events[key].length; e++) {
            var ev = events[key][e];
            var evDiv = document.createElement('div');
            evDiv.className = 'event';
            evDiv.style.top = (ev.h * 40) + 'px';
            evDiv.style.height = '35px';
            evDiv.style.background = 'rgba(59,130,246,0.3)';
            evDiv.style.borderLeftColor = ev.c || '#3b82f6';
            evDiv.innerHTML = ev.t;
            col.appendChild(evDiv);
          }
        }
        scroll.appendChild(col);
      }
      container.appendChild(scroll);
    }

    // Navigation
    document.getElementById('btnPrev').onclick = function() {
      if(currentMode==='M') viewDate.setMonth(viewDate.getMonth()-1);
      else viewDate.setDate(viewDate.getDate()-7);
      render();
    };
    document.getElementById('btnNext').onclick = function() {
      if(currentMode==='M') viewDate.setMonth(viewDate.getMonth()+1);
      else viewDate.setDate(viewDate.getDate()+7);
      render();
    };
    document.getElementById('modeM').onclick = function() {
      currentMode = 'M'; this.className='btn btn-active'; document.getElementById('modeW').className='btn';
      render();
    };
    document.getElementById('modeW').onclick = function() {
      currentMode = 'W'; this.className='btn btn-active'; document.getElementById('modeM').className='btn';
      render();
    };

    render();
  </script>
</body>
</html>
