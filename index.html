<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Smart Home Dashboard</title>
  <style>
    /* WICHTIG: Transparent für das Hintergrundbild */
    html, body { 
      height: 100%; margin: 0; padding: 0; 
      font-family: -apple-system, sans-serif; 
      background: transparent !important; 
      color: #fff; overflow: hidden; 
    }

    .bg-fixed { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; object-fit: cover; }
    .bg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.2); z-index: -5; }

    .wrap { 
      display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: center; -webkit-box-pack: justify;
      position: relative; z-index: 1; width: 100%; height: 100vh; box-sizing: border-box; padding: 25px;
    }

    /* Panel Dimensionen */
    .left { width: 33%; height: 600px; }
    .right { 
      width: 65%; height: 600px; 
      background: rgba(15, 23, 42, 0.5); 
      border-radius: 25px; border: 1px solid rgba(255,255,255,0.2); 
      position: relative; overflow: hidden;
    }

    .panel-clock { 
      background: rgba(15, 23, 42, 0.5); border-radius: 25px; border: 1px solid rgba(255,255,255,0.2);
      height: 100%; display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-pack: center; -webkit-box-align: center;
    }

    .time { font-size: 8rem; font-weight: bold; line-height: 1; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
    .date-line { font-size: 1.8rem; margin-bottom: 10px; opacity: 0.9; }

    /* Header Fix */
    .cal-header {
      height: 70px; display: -webkit-box; -webkit-box-align: center; padding: 0 15px;
      background: rgba(255,255,255,0.1); border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .header-title { -webkit-box-flex: 1; text-align: center; font-size: 1.6rem; font-weight: bold; }
    
    .btn-group { display: -webkit-box; }
    .btn { 
      background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.2);
      color: white; width: 50px; height: 45px; border-radius: 12px; margin: 0 4px;
      font-size: 1.2rem; text-align: center; line-height: 43px;
    }
    .btn.active { background: #3b82f6; border-color: #60a5fa; }

    /* Grid Layout */
    .cal-container { padding: 10px; height: 510px; box-sizing: border-box; }
    .cal-table { display: table; width: 100%; table-layout: fixed; height: 100%; border-collapse: collapse; }
    .cal-row { display: table-row; }
    .cal-cell { 
      display: table-cell; border: 1px solid rgba(255,255,255,0.1); 
      vertical-align: top; padding: 6px; background: rgba(255,255,255,0.05);
    }
    
    .cal-cell.head { height: 35px; text-align: center; vertical-align: middle; font-weight: bold; font-size: 0.9rem; border: none; background: transparent; }
    .cal-cell.kw { width: 45px; text-align: center; vertical-align: middle; color: #3b82f6; font-weight: bold; }

    /* Monatsansicht: Zeilenhöhe automatisch */
    .month-view .cal-cell { height: 85px; }
    
    /* Wochenansicht: Eine Zeile füllt den Rest (Bild 3) */
    .week-view .cal-cell { height: 440px; } 

    .day-num { font-weight: bold; font-size: 1.2rem; margin-bottom: 4px; }
    .today { background: rgba(59, 130, 246, 0.4) !important; border: 1px solid #3b82f6; }
    
    .event { 
      background: #f97316; font-size: 0.7rem; padding: 3px 6px; border-radius: 5px; 
      margin-top: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
  </style>
</head>
<body>

  <img src="Winter_1.jpg" class="bg-fixed">
  <div class="bg-overlay"></div>

  <div class="wrap">
    <div class="left">
      <div class="panel-clock">
        <div id="dateLine" class="date-line">-</div>
        <div id="hoursMinutes" class="time">00:00</div>
      </div>
    </div>

    <div class="right">
      <div class="cal-header">
        <div class="btn-group">
          <button class="btn" onclick="moveDate(-1)">&#10094;</button>
          <button class="btn" onclick="moveDate(1)">&#10095;</button>
          <button class="btn" onclick="resetDate()">&#8634;</button>
        </div>
        <div id="monthLabel" class="header-title">-</div>
        <div class="btn-group">
          <button id="btnMonth" class="btn active" onclick="setView('month')">田</button>
          <button id="btnWeek" class="btn" onclick="setView('week')">◷</button>
        </div>
      </div>
      <div id="calContainer" class="cal-container"></div>
    </div>
  </div>

  <script>
    var viewDate = new Date(), currentView = 'month', events = {};

    function updateClock() {
      var n = new Date(), d = ['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'];
      document.getElementById('hoursMinutes').textContent = (n.getHours()<10?'0':'')+n.getHours()+':'+(n.getMinutes()<10?'0':'')+n.getMinutes();
      document.getElementById('dateLine').textContent = d[n.getDay()] + ', ' + n.getDate() + '.' + (n.getMonth()+1) + '.';
    }
    setInterval(updateClock, 1000); updateClock();

    function getKW(d) {
      var date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      date.setUTCDate(date.getUTCDate() + 4 - (date.getUTCDay()||7));
      return Math.ceil((((date - new Date(Date.UTC(date.getUTCFullYear(),0,1))) / 86400000) + 1)/7);
    }

    function render() {
      var container = document.getElementById('calContainer');
      container.innerHTML = '';
      var table = document.createElement('div'); 
      table.className = 'cal-table ' + (currentView === 'month' ? 'month-view' : 'week-view');
      
      var hr = document.createElement('div'); hr.className = 'cal-row';
      ['KW','Mo','Di','Mi','Do','Fr','Sa','So'].forEach(function(t){
        var c = document.createElement('div'); c.className = 'cal-cell head'; c.textContent = t; hr.appendChild(c);
      });
      table.appendChild(hr);

      if(currentView === 'month') {
        var y = viewDate.getFullYear(), m = viewDate.getMonth();
        var months = ['Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'];
        document.getElementById('monthLabel').textContent = months[m] + ' ' + y;
        var first = new Date(y, m, 1).getDay(); first = (first === 0) ? 6 : first - 1;
        var last = new Date(y, m + 1, 0).getDate();
        var day = 1 - first;

        for(var w=0; w<6; w++) {
          var row = document.createElement('div'); row.className = 'cal-row';
          var kc = document.createElement('div'); kc.className = 'cal-cell kw';
          kc.textContent = getKW(new Date(y, m, day + (day<1?first:0))); row.appendChild(kc);
          for(var d=0; d<7; d++) {
            var cell = document.createElement('div'); cell.className = 'cal-cell';
            if(day > 0 && day <= last) {
              if(day===new Date().getDate() && m===new Date().getMonth() && y===new Date().getFullYear()) cell.className += ' today';
              cell.innerHTML = '<div class="day-num">'+day+'</div>';
              var k = y+'-'+m+'-'+day; if(events[k]) events[k].forEach(function(e){ cell.innerHTML += '<div class="event">'+e+'</div>'; });
            }
            row.appendChild(cell); day++;
          }
          table.appendChild(row); if(day > last) break;
        }
      } else {
        var s = new Date(viewDate); var dIdx = s.getDay();
        s.setDate(s.getDate() - (dIdx === 0 ? 6 : dIdx - 1));
        document.getElementById('monthLabel').textContent = "KW " + getKW(s);
        var row = document.createElement('div'); row.className = 'cal-row';
        var kc = document.createElement('div'); kc.className = 'cal-cell kw'; kc.textContent = getKW(s); row.appendChild(kc);
        for(var i=0; i<7; i++) {
          var cell = document.createElement('div'); cell.className = 'cal-cell';
          var curr = new Date(s); curr.setDate(s.getDate() + i);
          if(curr.toDateString() === new Date().toDateString()) cell.className += ' today';
          cell.innerHTML = '<div class="day-num">'+curr.getDate()+'.'+(curr.getMonth()+1)+'.</div>';
          var k = curr.getFullYear()+'-'+curr.getMonth()+'-'+curr.getDate();
          if(events[k]) events[k].forEach(function(e){ cell.innerHTML += '<div class="event">'+e+'</div>'; });
          row.appendChild(cell);
        }
        table.appendChild(row);
      }
      container.appendChild(table);
    }

    function moveDate(dir) { if(currentView==='month') viewDate.setMonth(viewDate.getMonth()+dir); else viewDate.setDate(viewDate.getDate()+(dir*7)); render(); }
    function resetDate() { viewDate = new Date(); render(); }
    function setView(v) { 
      currentView = v; 
      document.getElementById('btnMonth').className = 'btn' + (v==='month'?' active':'');
      document.getElementById('btnWeek').className = 'btn' + (v==='week'?' active':'');
      render(); 
    }
    render();
  </script>
</body>
</html>
